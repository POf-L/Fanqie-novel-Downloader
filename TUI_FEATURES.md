# 启动器TUI功能说明

## 概述

为番茄小说下载器启动器添加了TUI（文本用户界面）功能，提供更好的可视化体验。

## 功能特性

### 🎨 美观的界面
- 使用Rich库提供彩色文本和表格显示
- 清晰的状态指示（成功/警告/错误/信息）
- 结构化的调试信息展示

### 📊 可视化进度
- **镜像测速进度**：实时显示GitHub镜像节点和pip镜像源的测速进度
- **下载进度条**：Runtime下载时显示详细的进度条，包括下载速度和剩余时间
- **安装进度**：依赖安装时的进度指示

### 🎯 增强的交互
- **选择菜单**：美观的选项菜单，支持键盘选择
- **镜像表格**：清晰的镜像延迟对比表格
- **状态反馈**：实时状态更新和错误提示

## 兼容性

### 自动降级
- 如果Rich库不可用，自动回退到传统命令行界面
- 如果终端不支持TUI（如重定向输出），使用文本模式
- 保持所有原有功能的完整性

### 环境支持
- ✅ Windows终端
- ✅ Linux/macOS终端
- ✅ Git Bash
- ✅ VS Code终端
- ✅ PyCharm终端
- ✅ 打包后的可执行文件

## 使用方法

### 启动应用
```bash
# 正常启动（自动检测TUI可用性）
python launcher.py

# 或直接运行打包后的可执行文件
./FanqieLauncher-windows-x64.exe
```

### TUI界面展示

#### 1. 启动界面
```
┌─────────────────────────────────────┐
│        番茄小说下载器 启动器        │
└─────────────────────────────────────┘
```

#### 2. 调试信息
```
┌─────────────────────────────────────┐
│              环境信息               │
├──────────┬──────────────────────────┤
│ Python版本 │ 3.11.0                │
│ 平台      │ Windows                │
│ TUI状态   │ 启用                   │
└──────────┴──────────────────────────┘
```

#### 3. 选择下载方式
```
选择下载方式
  1. 直连 GitHub - 不使用代理，直接连接GitHub
  2. 直连 GitHub - 使用系统代理
  3. 使用镜像节点 - 通过GitHub镜像节点下载
请输入选项 [1-3] (3):
```

#### 4. 镜像选择表格
```
┌──────┬──────────────────┬───────┐
│ 编号 │ 镜像名称         │  延迟 │
├──────┼──────────────────┼───────┤
│ 1    │ ghproxy.vip      │ 150ms │
│ 2    │ gh.llkk.cc       │ 200ms │
│ 3    │ github.com      │ 300ms │
└──────┴──────────────────┴───────┘
```

#### 5. 进度显示
```
正在测试镜像节点延迟... ⠙
下载 Runtime (v2024.01.01.1234) ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 75% 15.2MB/20.3MB 2.1MB/s
安装Runtime依赖... ⠹
```

## 配置选项

### 强制禁用TUI
如果遇到兼容性问题，可以通过环境变量禁用TUI：
```bash
export NO_TUI=1
python launcher.py
```

### 依赖要求
- Python 3.6+
- Rich库（>=13.0.0，自动安装）

## 故障排除

### TUI不显示
1. 检查Rich库是否安装：`pip install rich>=13.0.0`
2. 确认终端支持ANSI颜色
3. 检查是否在支持TTY的环境中

### 显示异常
1. 尝试更新Rich库：`pip install --upgrade rich`
2. 检查终端编码设置（建议UTF-8）
3. 如果问题持续，设置`NO_TUI=1`使用文本模式

### 性能问题
TUI功能对性能影响极小，主要开销在：
- 镜像测速（原有功能）
- 进度条渲染（<1%额外开销）

## 开发信息

### 文件结构
```
utils/launcher_tui.py     # TUI核心组件
launcher.py               # 启动器主文件（已集成TUI）
test_tui.py              # TUI功能测试脚本
config/requirements.txt  # 已添加rich依赖
```

### 扩展TUI
可以通过修改`utils/launcher_tui.py`来添加更多TUI功能：
- 新的进度显示类型
- 自定义主题和颜色
- 额外的交互组件

## 测试

运行TUI功能测试：
```bash
python test_tui.py
```

测试包括：
- 基础功能测试
- 交互功能测试  
- 进度显示测试

---

**注意**：TUI功能是可选的增强功能，不会影响原有启动器的稳定性和功能。如果遇到任何问题，启动器会自动回退到传统的命令行界面。
